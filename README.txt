#-------------------
# README for Swin-Mamba
#-------------------

ğŸ§© Swin-Mamba Overall Architecture

Input Video Frames  (B, T, C, H, W)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Patch Embedding         â”‚  â† same as Swin
â”‚  (Conv2D / Linear projection)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
Tokens: (B, T, N, C)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Swin-Mamba Stage 1               â”‚
â”‚                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Swin-Mamba Block â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  LN â†’ **Mamba** â†’ Residual           â”‚  â”‚
â”‚  â”‚  LN â†’ MLP â†’ Residual                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Swin-Mamba Block â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  LN â†’ **Mamba** â†’ Residual           â”‚  â”‚
â”‚  â”‚  LN â†’ MLP â†’ Residual                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                            â”‚
â”‚   â†“ Patch Merging (spatial downsample)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Swin-Mamba Stage 2               â”‚
â”‚        (same structure, more channels)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Swin-Mamba Stage 3               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Swin-Mamba Stage 4               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
Global Pooling over spatial + temporal
        â”‚
        â–¼
Classifier (FC)
        â”‚
        â–¼
Emotion Class

--------------------------------------------------------------

Inside One Swin-Mamba Block

Input Tokens (B, T, N, C)
        â”‚
        â–¼
   LayerNorm
        â”‚
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚       Mamba         â”‚   â† replaces Self-Attention
   â”‚ (state-space model) â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
 + Residual Connection
        â”‚
        â–¼
   LayerNorm
        â”‚
        â–¼
        MLP
        â”‚
        â–¼
 + Residual Connection
        â”‚
        â–¼
 Output Tokens

--------------------------------------------------------------

ğŸªŸ How Windowing Works (Per Frame)

Frame tokens (HÃ—W)
      â”‚
      â–¼
Split into Windows (7Ã—7)
      â”‚
      â–¼
Each window â†’ sequence length = 49
      â”‚
      â–¼
Mamba processes each window sequence
      â”‚
      â–¼
Shift windows (next block)

-----------------------------------
ğŸ§© 1. Patch embedding (first thing that happens)

From each frame:

Input frame: (C, H, W)

Patch size = PÃ—P

â†’ Split into patches
â†’ Linear projection

Result:
Tokens: (N = (H/P) Ã— (W/P), C)
H=W=224, P=4 â†’ 56Ã—56 = 3136 patch tokens

----------------------------------------------

ğŸªŸ 2. Window partitioning = grouping of patches

Now those patch tokens are grouped into windows:

Patch grid: 56 Ã— 56

Window size = 7 Ã— 7 patches

â†’ Number of windows = (56/7) Ã— (56/7) = 8 Ã— 8 = 64 windows
â†’ Each window contains 7 Ã— 7 = 49 patch tokens


So a window is not raw pixels â€”
it is a local neighborhood of patch tokens.

-------------------------------------------
